# 开发规格（DevSpec）- 管理面板（重构阶段）

## 1. 当前决策

- 文档版本：v2.0（2026-02-11）
- 当前阶段不新开独立管理后台项目
- 先复用 `study-app` 中“题库库 + 智能解析”能力作为轻量管理入口
- 管理后台完整版（审核/发布/报错工单/统计看板）延后到 V2

## 2. 本阶段最小管理能力（必须）

### 2.1 题库资产可见
- 管理者账号可查看自己上传的全部题库
- 展示字段：标题、状态、创建时间、更新时间、最新任务进度

### 2.2 失败任务可追踪
- 对 `failed` 状态题库展示错误信息（`quiz.errorMsg` / `job.error`）
- 支持删除失败题库并重新上传

### 2.3 已完成题库可复用
- `completed` 状态可预览 HTML
- 可下载 HTML 作为交付物

### 2.4 安全边界
- 所有管理动作必须登录后执行
- 严格按 `user_id` 过滤，不允许跨用户访问

## 3. 后端支撑接口（当前已定义）

- `GET /api/quiz`
- `GET /api/quiz/:id`
- `DELETE /api/quiz/:id`
- `GET /api/job`
- `GET /api/job/:id`

## 4. 数据模型（本阶段）

- `users`
- `quizzes`
- `jobs`

说明：`parse_logs` 作为后续优化日志表，本阶段可选实现。

## 5. 上线门槛

1. 管理者可通过注册/登录进入系统。
2. 可完成一次上传到生成的全链路。
3. 失败任务能看到明确错误并可重试（通过重新上传）。
4. 无本地 Postgres 依赖，统一使用 Supabase Postgres。

## 6. V2 再做（不阻塞当前）

- 题库发布/下架审核流
- 用户报错工单系统
- AI 核实答案与解析补全
- 统计看板（成功率、耗时、活跃度）
- 多管理员角色权限控制
